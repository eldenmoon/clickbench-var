SELECT COUNT(*) FROM hits_jsonb;
SELECT COUNT(*) FROM hits_jsonb WHERE jsonb_extract_int(var, "$.AdvEngineID") <> 0;
SELECT SUM(jsonb_extract_int(var, "$.AdvEngineID")), COUNT(*), AVG(jsonb_extract_int(var, "$.ResolutionWidth")) FROM hits_jsonb;
SELECT AVG(UserID) FROM hits_jsonb;
SELECT COUNT(DISTINCT UserID) FROM hits_jsonb;
SELECT COUNT(DISTINCT jsonb_extract_string(var, "$.SearchPhrase")) FROM hits_jsonb;
SELECT MIN(EventDate), MAX(EventDate) FROM hits_jsonb;
SELECT jsonb_extract_int(var, "$.AdvEngineID"), COUNT(*) FROM hits_jsonb WHERE jsonb_extract_int(var, "$.AdvEngineID") <> 0 GROUP BY jsonb_extract_int(var, "$.AdvEngineID") ORDER BY COUNT(*) DESC;
SELECT jsonb_extract_int(var, "$.RegionID"), COUNT(DISTINCT UserID) AS u FROM hits_jsonb GROUP BY jsonb_extract_int(var, "$.RegionID") ORDER BY u DESC LIMIT 10;
SELECT jsonb_extract_int(var, "$.RegionID"), SUM(jsonb_extract_int(var, "$.AdvEngineID")), COUNT(*) AS c, AVG(jsonb_extract_int(var, "$.ResolutionWidth")), COUNT(DISTINCT UserID) FROM hits_jsonb GROUP BY jsonb_extract_int(var, "$.RegionID") ORDER BY c DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.MobilePhoneModel"), COUNT(DISTINCT UserID) AS u FROM hits_jsonb WHERE jsonb_extract_string(var, "$.MobilePhoneModel") <> '' GROUP BY jsonb_extract_string(var, "$.MobilePhoneModel") ORDER BY u DESC LIMIT 10;
SELECT jsonb_extract_int(var, "$.MobilePhone") as MobilePhoneNumber, jsonb_extract_string(var, "$.MobilePhoneModel"), COUNT(DISTINCT UserID) AS u FROM hits_jsonb WHERE jsonb_extract_string(var, "$.MobilePhoneModel") <> '' GROUP BY MobilePhoneNumber, jsonb_extract_string(var, "$.MobilePhoneModel") ORDER BY u DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.SearchPhrase"), COUNT(*) AS c FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' GROUP BY jsonb_extract_string(var, "$.SearchPhrase") ORDER BY c DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.SearchPhrase"), COUNT(DISTINCT UserID) AS u FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' GROUP BY jsonb_extract_string(var, "$.SearchPhrase") ORDER BY u DESC LIMIT 10;
SELECT jsonb_extract_int(var, "$.SearchEngineID") as SearchEngineID, jsonb_extract_string(var, "$.SearchPhrase"), COUNT(*) AS c FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' GROUP BY SearchEngineID, jsonb_extract_string(var, "$.SearchPhrase") ORDER BY c DESC LIMIT 10;
SELECT UserID, COUNT(*) FROM hits_jsonb GROUP BY UserID ORDER BY COUNT(*) DESC LIMIT 10;
SELECT UserID, jsonb_extract_string(var, "$.SearchPhrase"), COUNT(*) FROM hits_jsonb GROUP BY UserID, jsonb_extract_string(var, "$.SearchPhrase") ORDER BY COUNT(*) DESC LIMIT 10;
SELECT UserID, jsonb_extract_string(var, "$.SearchPhrase"), COUNT(*) FROM hits_jsonb GROUP BY UserID, jsonb_extract_string(var, "$.SearchPhrase") LIMIT 10;
SELECT UserID, extract(minute FROM EventTime) AS m, jsonb_extract_string(var, "$.SearchPhrase"), COUNT(*) FROM hits_jsonb GROUP BY UserID, m, jsonb_extract_string(var, "$.SearchPhrase") ORDER BY COUNT(*) DESC LIMIT 10;
SELECT UserID FROM hits_jsonb WHERE UserID = 435090932899640449;
SELECT COUNT(*) FROM hits_jsonb WHERE jsonb_extract_string(var, "$.URL") LIKE '%google%';
SELECT jsonb_extract_string(var, "$.SearchPhrase"), MIN(jsonb_extract_string(var, "$.URL")), COUNT(*) AS c FROM hits_jsonb WHERE jsonb_extract_string(var, "$.URL") LIKE '%google%' AND jsonb_extract_string(var, "$.SearchPhrase") <> '' GROUP BY jsonb_extract_string(var, "$.SearchPhrase") ORDER BY c DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.SearchPhrase"), MIN(jsonb_extract_string(var, "$.URL")), MIN(jsonb_extract_string(var, "$.Title")), COUNT(*) AS c, COUNT(DISTINCT UserID) FROM hits_jsonb WHERE jsonb_extract_string(var, "$.Title") LIKE '%Google%' AND jsonb_extract_string(var, "$.URL") NOT LIKE '%.google.%' AND jsonb_extract_string(var, "$.SearchPhrase") <> '' GROUP BY jsonb_extract_string(var, "$.SearchPhrase") ORDER BY c DESC LIMIT 10;
SELECT * FROM hits_jsonb WHERE jsonb_extract_string(var, "$.URL") LIKE '%google%' ORDER BY EventTime LIMIT 10;
SELECT jsonb_extract_string(var, "$.SearchPhrase") FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' ORDER BY EventTime LIMIT 10;
SELECT jsonb_extract_string(var, "$.SearchPhrase") FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' ORDER BY jsonb_extract_string(var, "$.SearchPhrase") LIMIT 10;
SELECT jsonb_extract_string(var, "$.SearchPhrase") FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' ORDER BY EventTime, jsonb_extract_string(var, "$.SearchPhrase") LIMIT 10;
SELECT jsonb_extract_int(var, "$.CounterID"), AVG(length(jsonb_extract_string(var, "$.URL"))) AS l, COUNT(*) AS c FROM hits_jsonb WHERE jsonb_extract_string(var, "$.URL") <> '' GROUP BY jsonb_extract_int(var, "$.CounterID") HAVING COUNT(*) > 100000 ORDER BY l DESC LIMIT 25;
SELECT REGEXP_REPLACE(jsonb_extract_string(var, "$.Referer"), '^https?://(?:www\.)?([^/]+)/.*$', '\\1') AS k, AVG(length(jsonb_extract_string(var, "$.Referer"))) AS l, COUNT(*) AS c, MIN(jsonb_extract_string(var, "$.Referer")) FROM hits_jsonb WHERE jsonb_extract_string(var, "$.Referer") <> '' GROUP BY k HAVING COUNT(*) > 100000 ORDER BY l DESC LIMIT 25;
SELECT SUM(jsonb_extract_int(var, "$.ResolutionWidth")), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 1), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 2), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 3), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 4), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 5), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 6), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 7), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 8), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 9), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 10), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 11), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 12), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 13), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 14), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 15), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 16), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 17), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 18), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 19), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 20), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 21), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 22), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 23), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 24), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 25), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 26), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 27), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 28), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 29), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 30), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 31), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 32), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 33), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 34), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 35), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 36), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 37), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 38), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 39), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 40), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 41), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 42), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 43), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 44), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 45), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 46), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 47), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 48), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 49), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 50), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 51), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 52), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 53), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 54), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 55), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 56), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 57), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 58), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 59), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 60), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 61), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 62), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 63), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 64), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 65), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 66), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 67), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 68), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 69), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 70), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 71), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 72), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 73), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 74), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 75), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 76), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 77), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 78), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 79), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 80), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 81), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 82), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 83), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 84), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 85), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 86), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 87), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 88), SUM(jsonb_extract_int(var, "$.ResolutionWidth") + 89) FROM hits_jsonb;
SELECT jsonb_extract_int(var, "$.SearchEngineID") as SearchEngineID, jsonb_extract_int(var, "$.ClientIP"), COUNT(*) AS c, SUM(jsonb_extract_int(var, "$.IsRefresh")), AVG(jsonb_extract_int(var, "$.ResolutionWidth")) FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' GROUP BY SearchEngineID, jsonb_extract_int(var, "$.ClientIP") ORDER BY c DESC LIMIT 10;
SELECT WatchID, jsonb_extract_int(var, "$.ClientIP"), COUNT(*) AS c, SUM(jsonb_extract_int(var, "$.IsRefresh")), AVG(jsonb_extract_int(var, "$.ResolutionWidth")) FROM hits_jsonb WHERE jsonb_extract_string(var, "$.SearchPhrase") <> '' GROUP BY WatchID, jsonb_extract_int(var, "$.ClientIP") ORDER BY c DESC LIMIT 10;
SELECT WatchID, jsonb_extract_int(var, "$.ClientIP"), COUNT(*) AS c, SUM(jsonb_extract_int(var, "$.IsRefresh")), AVG(jsonb_extract_int(var, "$.ResolutionWidth")) FROM hits_jsonb GROUP BY WatchID, jsonb_extract_int(var, "$.ClientIP") ORDER BY c DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.URL"), COUNT(*) AS c FROM hits_jsonb GROUP BY jsonb_extract_string(var, "$.URL") ORDER BY c DESC LIMIT 10;
SELECT 1, jsonb_extract_string(var, "$.URL"), COUNT(*) AS c FROM hits_jsonb GROUP BY 1, jsonb_extract_string(var, "$.URL") ORDER BY c DESC LIMIT 10;
SELECT jsonb_extract_int(var, "$.ClientIP"), jsonb_extract_int(var, "$.ClientIP") - 1, jsonb_extract_int(var, "$.ClientIP") - 2, jsonb_extract_int(var, "$.ClientIP") - 3, COUNT(*) AS c FROM hits_jsonb GROUP BY jsonb_extract_int(var, "$.ClientIP"), jsonb_extract_int(var, "$.ClientIP") - 1, jsonb_extract_int(var, "$.ClientIP") - 2, jsonb_extract_int(var, "$.ClientIP") - 3 ORDER BY c DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.URL"), COUNT(*) AS PageViews FROM hits_jsonb WHERE jsonb_extract_int(var, "$.CounterID") = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND jsonb_extract_int(var, "$.DontCountHits") = 0 AND jsonb_extract_int(var, "$.IsRefresh") = 0 AND jsonb_extract_string(var, "$.URL") <> '' GROUP BY jsonb_extract_string(var, "$.URL") ORDER BY PageViews DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.Title"), COUNT(*) AS PageViews FROM hits_jsonb WHERE jsonb_extract_int(var, "$.CounterID") = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND jsonb_extract_int(var, "$.DontCountHits") = 0 AND jsonb_extract_int(var, "$.IsRefresh") = 0 AND jsonb_extract_string(var, "$.Title") <> '' GROUP BY jsonb_extract_string(var, "$.Title") ORDER BY PageViews DESC LIMIT 10;
SELECT jsonb_extract_string(var, "$.URL"), COUNT(*) AS PageViews FROM hits_jsonb WHERE jsonb_extract_int(var, "$.CounterID") = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND jsonb_extract_int(var, "$.IsRefresh") = 0 AND jsonb_extract_int(var, "$.IsLink") <> 0 AND jsonb_extract_int(var, "$.IsDownload") = 0 GROUP BY jsonb_extract_string(var, "$.URL") ORDER BY PageViews DESC LIMIT 10 OFFSET 1000;
SELECT jsonb_extract_int(var, "$.TraficSourceID"), jsonb_extract_int(var, "$.SearchEngineID"), jsonb_extract_int(var, "$.AdvEngineID"), CASE WHEN (jsonb_extract_int(var, "$.SearchEngineID") = 0 AND jsonb_extract_int(var, "$.AdvEngineID") = 0) THEN jsonb_extract_string(var, "$.Referer") ELSE '' END AS Src, jsonb_extract_string(var, "$.URL") AS Dst, COUNT(*) AS PageViews FROM hits_jsonb WHERE jsonb_extract_int(var, "$.CounterID") = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND jsonb_extract_int(var, "$.IsRefresh") = 0 GROUP BY jsonb_extract_int(var, "$.TraficSourceID"), jsonb_extract_int(var, "$.SearchEngineID"), jsonb_extract_int(var, "$.AdvEngineID") , Src, Dst ORDER BY PageViews DESC LIMIT 10 OFFSET 1000;
SELECT URLHash, EventDate, COUNT(*) AS PageViews FROM hits_jsonb WHERE jsonb_extract_int(var, "$.CounterID") = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND jsonb_extract_int(var, "$.IsRefresh") = 0 AND jsonb_extract_int(var, "$.TraficSourceID") IN (-1, 6) AND RefererHash = 3594120000172545465 GROUP BY URLHash, EventDate ORDER BY PageViews DESC LIMIT 10 OFFSET 100;
SELECT jsonb_extract_int(var, "$.WindowClientWidth"), jsonb_extract_int(var, "$.WindowClientHeight"), COUNT(*) AS PageViews FROM hits_jsonb WHERE jsonb_extract_int(var, "$.CounterID") = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND jsonb_extract_int(var, "$.IsRefresh") = 0 AND jsonb_extract_int(var, "$.DontCountHits") = 0 AND URLHash = 2868770270353813622 GROUP BY jsonb_extract_int(var, "$.WindowClientWidth"), jsonb_extract_int(var, "$.WindowClientHeight") ORDER BY PageViews DESC LIMIT 10 OFFSET 10000;
SELECT DATE_FORMAT(EventTime, '%Y-%m-%d %H:%i:00') AS M, COUNT(*) AS PageViews FROM hits_jsonb WHERE jsonb_extract_int(var, "$.CounterID") = 62 AND EventDate >= '2013-07-14' AND EventDate <= '2013-07-15' AND jsonb_extract_int(var, "$.IsRefresh") = 0 AND jsonb_extract_int(var, "$.DontCountHits") = 0 GROUP BY DATE_FORMAT(EventTime, '%Y-%m-%d %H:%i:00') ORDER BY DATE_FORMAT(EventTime, '%Y-%m-%d %H:%i:00') LIMIT 10 OFFSET 1000;

